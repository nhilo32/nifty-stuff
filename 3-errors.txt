[hilo@ip-10-22-4-214 neal]$ cat ../.aws/credentials
[VDMS]
role_arn = arn:aws-us-gov:iam::236402593911:role/OrganizationAccountAccessRole
region = us-gov-west-1
output = text
[hilo@ip-10-22-4-214 neal]$
[hilo@ip-10-22-4-214 neal]$ cat main.tf
provider "aws" {
  region = "us-gov-west-1"
  profile = "VDMS"
  sts_region = "us-gov-west-1"
}

resource "aws_dynamodb_table" "terraform-locks" {
  hash_key = "LockID"
  name = "hilo-test-table"
  billing_mode = "PAY_PER_REQUEST"
  attribute {
    name = "LockID"
    type = "S"
  }
}
[hilo@ip-10-22-4-214 neal]$
[hilo@ip-10-22-4-214 neal]$ terraform plan
╷
│ Error: Error acquiring the state lock
│
│ Error message: 2 errors occurred:
│       * operation error DynamoDB: PutItem, https response error StatusCode: 400, RequestID: 6NPREI168P8GUIIMF6S5R47LKJVV4KQNSO5AEMVJF66Q9ASUAAJG, api error
│ AccessDeniedException: User: arn:aws-us-gov:sts::179381774813:assumed-role/ManagedInstanceProfile/i-07051b8a9bb13c416 is not authorized to perform: dynamodb:PutItem
│ on resource: arn:aws-us-gov:dynamodb:us-gov-west-1:179381774813:table/credence-ilf4-terraform-locks because no identity-based policy allows the dynamodb:PutItem
│ action
│       * Unable to retrieve item from DynamoDB table "credence-ilf4-terraform-locks": operation error DynamoDB: GetItem, https response error StatusCode: 400, RequestID:
│ 9NUFHJASVS0KC8BQ0MT33BO0JFVV4KQNSO5AEMVJF66Q9ASUAAJG, api error AccessDeniedException: User:
│ arn:aws-us-gov:sts::179381774813:assumed-role/ManagedInstanceProfile/i-07051b8a9bb13c416 is not authorized to perform: dynamodb:GetItem on resource:
│ arn:aws-us-gov:dynamodb:us-gov-west-1:179381774813:table/credence-ilf4-terraform-locks because no identity-based policy allows the dynamodb:GetItem action
│
│
│
│ Terraform acquires a state lock to protect the state from being written
│ by multiple users at the same time. Please resolve the issue above and try
│ again. For most commands, you can disable locking with the "-lock=false"
│ flag, but this is not recommended.
